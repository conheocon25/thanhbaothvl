<!DOCTYPE html>
<html lang="en">
	<head>
		<span metal:use-macro="mApplication.xhtml/IncludeMETA"/>
		<span metal:use-macro="mApplication.xhtml/IncludeCSS"/>
		<span metal:use-macro="mApplication.xhtml/IncludeJS"/>		
	</head>
	<body>		
		<div class="container-fluid">
			<span metal:use-macro="mApplication.xhtml/Header"/>
			<div metal:use-macro="mApplication.xhtml/Menu"/>
			<div id="content">
				<div metal:use-macro="mApplication.xhtml/ContentHeader"/>
				<div metal:use-macro="mApplication.xhtml/LocationBar"/>
				<div class="container-fluid">
					<div class="row">
						<div class="col-12">							
							<div align="center" class="well">
									<label id="IdUser" tal:attributes="alt User/getId" align="center" tal:content="User/getNote" ></label>
									Điểm CM: <b style="color:red;" tal:content="php:NTotal->formatCurrency()"/>							
									- Điểm ABC: <b style="color:red;" tal:content="php:NTotalABC->formatCurrency()"/>
									 - <a align="center" class="brand" data-toggle="modal" href="#DialogChangeTime" > <i class="glyphicon glyphicon-time" style="margin-top:-5px;margin-right:5px;"/> Tháng <span tal:content="php: @\MVC\Base\SessionRegistry::instance()->getCurrentMonth()"/> Năm <span tal:content="php: @\MVC\Base\SessionRegistry::instance()->getCurrentYear()"/></a>
							</div>				
							
								<div style="color:white;" class="control-group">
									<label class="control-label">Tên Chương trình</label>
									<div class="controls">
										<select id="IdCategory" name="IdCategory" >
											<option tal:repeat="CategoryPrograme CategoryProgrameAll" tal:attributes="value CategoryPrograme/getId" >
												<span  tal:content="CategoryPrograme/getName"/>
											</option>
										</select>
									</div>								
									<label class="control-label">Ngày làm</label>									
									<div class='controls'>
										<input style="width:30%;" type='text' class="form-control" name="DateStart"  id='DateStart'/>
									</div>
									
									<label class="control-label">Số lượng</label>
									<div class="controls">										
										<select id="Count" name="Count">
											<option value = "1" >
												<span>1 Lần/ngày</span>
											</option>
											<option value = "2" >
												<span>2 Lần/ngày</span>
											</option>
											<option value = "3" >
												<span>3 Lần/ngày</span>
											</option>
											<option value = "4" >
												<span>4 Lần/ngày</span>
											</option>
											<option value = "5" >
												<span>5 Lần/ngày</span>
											</option>
										</select>
									</div>								
									<label class="control-label" for="Content">Nội dung</label>
									<div class="controls">
										<textarea style="width:50%;" id="Content" name="Content" />
									</div>	
								</div>
								<div class="control-group">
									<div class="controls">
										<button id="BtnAddReward" class="btn btn-primary btn-ins" value="submit-value">Thêm mới</button>
									</div>
								</div>						
							
							<div id="RewardLoad" />							
						</div>
					</div>
				</div>
			</div>			
		</div>
		<span metal:use-macro="mApplication.xhtml/Footer"/>		
		<span metal:use-macro="mApplication.xhtml/DialogChangeTime"/>
		<script type="text/javascript">
		/*<![CDATA[*/		
            //var Name 		= $(this).val();										
			$("#RewardLoad").load("/thu-lao/reward/trang", { Page: 1 });
			
			$('#DateStart').datetimepicker();
			
			$('#URLChangeTimeButton').click(function(e){				
				var mYear 	= $("#mYear").val();
				var mMonth 	= $("#mMonth").val();				
				URL = "thu-lao/app/changetime/"+mMonth+"/"+mYear;
				$.ajax({
					type: "POST", 
					async: false,
					url: URL,
					dataType: 'json',
					contentType:"application/json; charset=utf-8",	
					success: function(data){						
					}
				});
				location.reload(true);
			});
			$('#BtnAddReward').click(function(e){	
				
				var Data = [];
				Data[0] 	= 'null';
				Data[1] 	= $("#IdCategory").val();
				Data[2] 	= $("#IdUser").attr('alt');					
				Data[3] 	= $("#Content").val();	
				Data[4] 	= $("#Count").val();	
				Data[5] 	= $("#DateStart").val();	
				Data[6] 	= 'null';	
				Data[7] 	= '';	
				
				var URL = "/object/ins/Salarydaily";
					$.ajax({
						type: "POST",
						data: {Data:Data},
						url: URL,
						contentType:"application/json; charset=utf-8",
						success: function(msg){
							$("#RewardLoad").load("/thu-lao/reward/trang", { Page: 1 });
						}
					});
			});	
			
			$('#BtnAddReward1').click(function(e){	
			
				var Data = [];
				Data[0] 	= $("#IdCategory").selected();
				Data[1] 	= $("#DateStart").val();	
				Data[2] 	= $("#Count").val();			
				Data[3] 	= $("#Content").val();					
				
				URL = "thu-lao/reward/ins/exe";
				alert(URL);
				e.stopImmediatePropagation();
				$.ajax({
					type: "POST", 
					async: false,
					url: URL,
					data: {Data:Data},
					dataType: 'json',
					contentType:"application/json; charset=utf-8",	
					success: function(data){
						alert ("thanh cong");
					}
				});				
			});
		/*]]>*/
		</script>		
	</body>
</html>